Telegram Stats (Bot + Web)
==========================

–ö–æ–º–ø–ª–µ–∫—Å –∏–∑ Telegram-–±–æ—Ç–∞ –∏ Next.js –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è —Å–±–æ—Ä–∞, —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö. –•—Ä–∞–Ω–∏–ª–∏—â–µ ‚Äî PostgreSQL, –∫–µ—à ‚Äî Redis, –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ ‚Äî Gemini.

–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
----------
- –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ (Docker Compose)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env
- –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º (—Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∞–Ω–∞–ª–∏–∑, —Å–≤–æ—è —Ñ–∏—á–∞)
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Next.js)
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ä–µ—à–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AI
- –¢–µ—Å—Ç—ã

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env (–∫–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
--------------------------------------
```
BOT_TOKEN=your_telegram_bot_token
DATABASE_URL=postgres://postgres:postgres@postgres:5432/telegram_stats
REDIS_URL=redis://redis:6379
CACHE_TTL=1200
GEMINI_API_KEY=your_gemini_api_key
```
`CACHE_TTL` ‚Äî –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–µ—à–∞ –≤ Redis (—Å–µ–∫), –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20 –º–∏–Ω—É—Ç.


2. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞
-----------------
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: Docker + Docker Compose.

```bash
git clone <repository-url>
cd testTask
docker compose up --build
```

–ü–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞:
- –ë–æ—Ç –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç `BOT_TOKEN` –∏–∑ `.env`).
- Web: http://localhost:3001
- PostgreSQL: localhost:5432
- Redis: localhost:6379


3. –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º
-------------------------
- –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç. –õ—é–±–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î –≤–º–µ—Å—Ç–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
- –ö–æ–º–∞–Ω–¥–∞ `/stats` ‚Äî –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏:
  - ¬´üìà –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞¬ª: —Ç–æ–ø-10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ–±—â–∏–π —Å—á—ë—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∞–≤—Ç–æ—Ä–æ–≤.
  - ¬´üë§ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è¬ª: —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π, –≤—ã–±–æ—Ä –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.
  - –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã: —Å–µ–≥–æ–¥–Ω—è / –Ω–µ–¥–µ–ª—è / –º–µ—Å—è—Ü / –≤—Å—ë –≤—Ä–µ–º—è.
- –ö–æ–º–∞–Ω–¥–∞ `/analyze` (reply –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) ‚Äî —Å–æ–±–∏—Ä–∞–µ—Ç –¥–æ 80 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —é–∑–µ—Ä–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Gemini –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (—Å—Ç–∏–ª—å, —Ç–µ–º—ã, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —á–∞—Å—Ç—ã–µ —Å–ª–æ–≤–∞). –ê–Ω—Ç–∏-—Å–ø–∞–º: –∫—É–ª–¥–∞—É–Ω 5 –º–∏–Ω—É—Ç –¥–ª—è –Ω–µ-–∞–¥–º–∏–Ω–æ–≤.
- –ö–æ–º–∞–Ω–¥–∞ `/activity` ‚Äî **—Å–≤–æ—è —Ñ–∏—á–∞**:
  - –ë–µ–∑ reply: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –ø–æ —á–∞—Ç—É.
  - Reply –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞.
  - –§–∏–ª—å—Ç—Ä—ã: –Ω–µ–¥–µ–ª—è / –º–µ—Å—è—Ü / –≤—Å—ë –≤—Ä–µ–º—è (–±–µ–∑ ¬´—Å–µ–≥–æ–¥–Ω—è¬ª, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —à—É–º–∞ –º–∞–ª—ã—Ö –≤—ã–±–æ—Ä–æ–∫).

4. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (web/)
-----------------------
- Next.js (app router). –û–¥–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞: –≤–≤–æ–¥ username ‚Üí –∫–Ω–æ–ø–∫–∞ ¬´–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å¬ª ‚Üí –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞ (—Ç–æ—Ç –∂–µ —Å–µ—Ä–≤–∏—Å, —á—Ç–æ —É /analyze).
- –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker:
  ```bash
  cd web
  npm install
  npm run dev
  # PORT=3001 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, .env –ø—Ä–∏–Ω–∏–º–∞–µ—Ç DATABASE_URL –∏ GEMINI_API_KEY
  ```

5. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ä–µ—à–µ–Ω–∏—è
------------------------
- 4 —Å–µ—Ä–≤–∏—Å–∞ –≤ `docker-compose.yml`: postgres (15), redis (7), bot (Node.js + Telegraf), web (Next.js).
- –ß–∏—Å—Ç—ã–µ SQL —á–µ—Ä–µ–∑ `pg`, –±–µ–∑ ORM. –ö–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ ‚Äî —Å–≤–æ—è –º–æ–¥–µ–ª—å –≤ `bot/src/models` –∏ `web/models`.
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–µ—Ä–µ–∑ Redis (TTL –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è `CACHE_TTL`).
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ bot/web –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –¥–µ–ø–ª–æ—è. –û–±—â–∞—è –ª–æ–≥–∏–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Å–µ—Ä–≤–∏—Å—ã.
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ ¬´–°–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏¬ª –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ `GROUP BY EXTRACT(DOW)`; –∫–Ω–æ–ø–∫–∏ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞ ¬´—Å–µ–≥–æ–¥–Ω—è¬ª –¥–ª—è –±–æ–ª–µ–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏.

6. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AI
-------------------
- Google Gemini API ‚Äî –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ (/analyze –∏ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞).
- ChatGPT ‚Äî –ø–æ–º–æ—â—å –≤ —á–µ—Ä–Ω–æ–≤–∏–∫–∞—Ö –∫–æ–¥–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è docker —Ñ–∞–π–ª–æ–≤
- Cursor –ø–æ–º–æ—â—å –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–æ—Ç–∞, –ø–æ–¥–±–æ—Ä —Å—Ç–∏–ª–µ–π
- –†—É—á–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏: —Ç–∏–ø–∏–∑–∞—Ü–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ç–µ–ª–µ–≥—Ä–∞–º-—Ä–∞–∑–º–µ—Ç–∫–∞, Docker/Next.js –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.
- –û—Ü–µ–Ω–∫–∞ —ç–∫–æ–Ω–æ–º–∏–∏ –≤—Ä–µ–º–µ–Ω–∏: ~30‚Äì40%.

7. –¢–µ—Å—Ç—ã
--------
- Vitest –≤ –ø–∞–ø–∫–µ `bot/tests`. –ú–æ–∫–∞–µ–º –º–æ–¥–µ–ª–∏ –∏ –∫–µ—à, –ø–æ—ç—Ç–æ–º—É Postgres/Redis –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è.
- –ó–∞–ø—É—Å–∫:
  ```bash
  cd bot
  npm install
  npm test
  ```

8. –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
---------------------------------
- –ë–æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ: `cd bot && npm install && npm run dev` (–Ω—É–∂–Ω—ã –ª–æ–∫–∞–ª—å–Ω—ã–µ PostgreSQL/Redis –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã).
- –°–±–æ—Ä–∫–∞ –±–æ—Ç–∞: `npm run build && npm start`.
- Web –ª–æ–∫–∞–ª—å–Ω–æ: `cd web && npm install && npm run dev`.

9. –°–≤–æ—è —Ñ–∏—á–∞ ‚Äî ¬´–°–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏¬ª
-------------------------------------------
- –ß—Ç–æ –¥–µ–ª–∞–µ—Ç: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, –∫–æ–≥–¥–∞ —á–∞—Ç –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ.
- –ó–∞—á–µ–º: –ø–æ–Ω—è—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ –¥–Ω—è–º, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏—è/–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –≤ –ø–∏–∫–∏.
- –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: `/activity` (—á–∞—Ç) –∏–ª–∏ `/activity` –≤ reply –Ω–∞ —é–∑–µ—Ä–∞; –≤ –º–µ–Ω—é `/stats` –∫–Ω–æ–ø–∫–∞ ¬´üìÖ –°–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏¬ª. –§–∏–ª—å—Ç—Ä—ã: –Ω–µ–¥–µ–ª—è / –º–µ—Å—è—Ü / –≤—Å—ë –≤—Ä–µ–º—è.
